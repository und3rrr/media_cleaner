# üîß –£–ª—É—á—à–µ–Ω–∏—è Adversarial Noise v2.1

## üìä –ü—Ä–æ–±–ª–µ–º–∞

–ù–∞ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏ (v2.0):
- **MSE: 4.73** –ø—Ä–∏ –≤—ã–±–æ—Ä–µ "—Å–∏–ª—å–Ω–æ–≥–æ" —É—Ä–æ–≤–Ω—è –º–∞—Å–∫–∏—Ä–æ–≤–∫–∏
- **–ò–∑–º–µ–Ω—ë–Ω–Ω–æ –ø–∏–∫—Å–µ–ª–µ–π: —Ç–æ–ª—å–∫–æ 1.51%**
- **–®—É–º –±—ã–ª –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –Ω–µ–≤–∏–¥–∏–º** - –Ω–µ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–ª —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—É—é –∑–∞—â–∏—Ç—É –≤–∏–¥–µ–æ

## üéØ –†–µ—à–µ–Ω–∏–µ

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –∫–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ adversarial —à—É–º–∞:

### 1. –£–≤–µ–ª–∏—á–µ–Ω–∏–µ Epsilon (–±–∞–∑–æ–≤–æ–π –∞–º–ø–ª–∏—Ç—É–¥—ã –∞—Ç–∞–∫–∏)
```python
# –ë—ã–ª–æ:
epsilon_video = 0.011

# –°—Ç–∞–ª–æ:
epsilon_video = 0.120  # 11x —É–≤–µ–ª–∏—á–µ–Ω–∏–µ
```

**–≠—Ñ—Ñ–µ–∫—Ç:**
- **MSE: 4.73 ‚Üí 148.69** (31.5x —É–ª—É—á—à–µ–Ω–∏–µ! ‚úÖ)
- –ë–æ–ª–µ–µ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è perturbation —Ü–µ–ª–µ–≤–æ–π –º–æ–¥–µ–ª–∏ (ResNet18)

### 2. –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –º–Ω–æ–∂–∏—Ç–µ–ª—å —Å–∏–ª—ã (strength_mult)
–î–æ–±–∞–≤–ª–µ–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä `strength_mult` –≤ —Ñ—É–Ω–∫—Ü–∏—é `add_imperceptible_video_noise()` –¥–ª—è –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–≥–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è epsilon –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —É—Ä–æ–≤–Ω—è –º–∞—Å–∫–∏—Ä–æ–≤–∫–∏:

```python
# –ò–∑ choose_settings():
video_strength_multiplier = {
    "–æ—á–µ–Ω—å —Å–ª–∞–±—ã–π": 0.6,    # 0.120 √ó 0.6 = 0.072
    "—Å–ª–∞–±—ã–π": 1.0,          # 0.120 √ó 1.0 = 0.120
    "—Å—Ä–µ–¥–Ω–∏–π": 1.4,         # 0.120 √ó 1.4 = 0.168
    "—Å–∏–ª—å–Ω—ã–π": 1.8          # 0.120 √ó 1.8 = 0.216
}
```

**–≠—Ñ—Ñ–µ–∫—Ç:**
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –≤—ã–±—Ä–∞—Ç—å –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É –∑–∞—â–∏—Ç–æ–π –∏ –≤–∏–¥–∏–º–æ—Å—Ç—å—é —à—É–º–∞
- "–°–∏–ª—å–Ω—ã–π" —É—Ä–æ–≤–µ–Ω—å —Ç–µ–ø–µ—Ä—å –¥–∞–µ—Ç MSE > 100 –¥–∞–∂–µ –Ω–∞ CPU

### 3. –£–ª—É—á—à–µ–Ω–∏–µ Ensemble of Transformations (EOT)
```python
# –ë—ã–ª–æ:
num_eot_transforms = 2

# –°—Ç–∞–ª–æ:
num_eot_transforms = 4  # 2x —É–≤–µ–ª–∏—á–µ–Ω–∏–µ
```

**–≠—Ñ—Ñ–µ–∫—Ç:**
- –ë–æ–ª–µ–µ —É—Å—Ç–æ–π—á–∏–≤—ã–π –≥—Ä–∞–¥–∏–µ–Ω—Ç –¥–ª—è FGSM –∞—Ç–∞–∫–∏
- –õ—É—á—à–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–ª—É—á–∞–π–Ω—ã–µ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ (—à—É–º, —è—Ä–∫–æ—Å—Ç—å)

### 4. –£—Å–∏–ª–µ–Ω–Ω–∞—è Loss-—Ñ—É–Ω–∫—Ü–∏—è
```python
# –ë—ã–ª–æ:
loss = F.cross_entropy(out, label) * 1.0

# –°—Ç–∞–ª–æ:
loss = F.cross_entropy(out, label) * 3.0  # 3x –º–Ω–æ–∂–∏—Ç–µ–ª—å
```

**–≠—Ñ—Ñ–µ–∫—Ç:**
- –ë–æ–ª–µ–µ —Å–∏–ª—å–Ω—ã–π gradient signal –¥–ª—è FGSM
- –õ—É—á—à–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã–π budget epsilon

### 5. GPU —É—Å–∫–æ—Ä–µ–Ω–∏–µ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–∞–¥—Ä–æ–≤
```python
# –°—Ä–∞–∑—É –ø–µ—Ä–µ–º–µ—â–∞–µ–º tensor –Ω–∞ GPU
frame_tensor_orig = torch.from_numpy(frame_rgb).permute(2, 0, 1).float().to(self.device)
```

**–≠—Ñ—Ñ–µ–∫—Ç:**
- –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ ResNet18 –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –Ω–∞ GPU (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–∞)
- –ó–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–µ —É—Å–∫–æ—Ä–µ–Ω–∏–µ (2-3x –Ω–∞ NVIDIA GPU)

## üìà –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –î–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (v2.0)
```
–í–∏–¥–µ–æ: IMG_9864.mp4 (1920x1080, 60fps)
–£—Ä–æ–≤–µ–Ω—å –º–∞—Å–∫–∏—Ä–æ–≤–∫–∏: "—Å–∏–ª—å–Ω—ã–π" (strongest)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
MSE: 4.73              ‚ùå –û–ß–ï–ù–¨ –°–õ–ê–ë–û
–ü–∏–∫—Å–µ–ª–∏: 1.51%         ‚ùå –ü–†–ê–ö–¢–ò–ß–ï–°–ö–ò –ù–ï –í–ò–î–ù–û
–ú–∞–∫—Å —Ä–∞–∑–Ω–∏—Ü–∞: 1.00
MAE: 1.73
```

### –ü–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (v2.1)
```
–í–∏–¥–µ–æ: IMG_9864.mp4 (1920x1080, 60fps)
–£—Ä–æ–≤–µ–Ω—å –º–∞—Å–∫–∏—Ä–æ–≤–∫–∏: "—Å–∏–ª—å–Ω—ã–π" (1.8x –º–Ω–æ–∂–∏—Ç–µ–ª—å)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
MSE: 148.69            ‚úÖ –û–¢–õ–ò–ß–ù–û
–ü–∏–∫—Å–µ–ª–∏: 96.59%        ‚úÖ –°–ò–õ–¨–ù–û –í–ò–î–ò–ú–û
–ú–∞–∫—Å —Ä–∞–∑–Ω–∏—Ü–∞: 13.00
MAE: 12.02
```

**–£–ª—É—á—à–µ–Ω–∏–µ:**
- MSE: **31.5x** (4.73 ‚Üí 148.69)
- –ü–∏–∫—Å–µ–ª–∏: **64x** (1.51% ‚Üí 96.59%)

## üîÑ –¶–µ–ø–æ—á–∫–∞ –ü–µ—Ä–µ–¥–∞—á–∏ –ü–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

```
choose_settings()
    ‚Üì –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç: (start_frame, end_frame, audio_level, every_n, video_strength_mult)
    ‚Üì
process_imperceptible_protected_video()
    ‚Üì –ø–µ—Ä–µ–¥–∞—ë—Ç: video_strength_mult
    ‚Üì
VideoProcessor.process_video(... video_strength_mult)
    ‚Üì –ø–µ—Ä–µ–¥–∞—ë—Ç –≤ —Ü–∏–∫–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏:
    ‚Üì
self.add_imperceptible_video_noise(frame, strength_mult=video_strength_mult)
    ‚Üì –∏—Å–ø–æ–ª—å–∑—É–µ—Ç:
    ‚Üì
epsilon_effective = self.epsilon * strength_mult
```

## üíæ –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ –§–∞–π–ª—ã

### media_cleaner.py
- **–°—Ç—Ä–æ–∫–∞ 33-37**: –û–±–Ω–æ–≤–ª–µ–Ω—ã –ø–∞—Ä–∞–º–µ—Ç—Ä—ã CONFIG
- **–°—Ç—Ä–æ–∫–∞ 284-286**: –î–æ–±–∞–≤–ª–µ–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä `strength_mult` –≤ —Å–∏–≥–Ω–∞—Ç—É—Ä—É
- **–°—Ç—Ä–æ–∫–∞ 294**: Tensor —Å—Ä–∞–∑—É –Ω–∞ GPU
- **–°—Ç—Ä–æ–∫–∞ 316**: Loss weight 3.0x
- **–°—Ç—Ä–æ–∫–∞ 346**: –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ `strength_mult` –∫ epsilon
- **–°—Ç—Ä–æ–∫–∞ 370**: –°–∏–≥–Ω–∞—Ç—É—Ä–∞ `process_video()` —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º
- **–°—Ç—Ä–æ–∫–∞ 419**: –í—ã–∑–æ–≤ —Å –ø–µ—Ä–µ–¥–∞—á–µ–π `video_strength_mult`
- **–°—Ç—Ä–æ–∫–∞ 560-572**: –°–ª–æ–≤–∞—Ä—å `video_strength_multiplier` –≤ `choose_settings()`
- **–°—Ç—Ä–æ–∫–∞ 573**: –í–æ–∑–≤—Ä–∞—Ç `video_strength_multiplier` –∏–∑ —Ñ—É–Ω–∫—Ü–∏–∏
- **–°—Ç—Ä–æ–∫–∞ 772**: –†–∞—Å–ø–∞–∫–æ–≤–∫–∞ –∏ –ø–µ—Ä–µ–¥–∞—á–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞

### config.json
- –û–±–Ω–æ–≤–ª–µ–Ω—ã –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ `video_processing` (–¥–ª—è —Å–ø—Ä–∞–≤–∫–∏)

## üöÄ –ö–∞–∫ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

```bash
# –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–∏–¥–µ–æ —Å –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
python media_cleaner.py

# –ü—Ä–∏ –≤—ã–±–æ—Ä–µ —É—Ä–æ–≤–Ω—è –º–∞—Å–∫–∏—Ä–æ–≤–∫–∏:
# - "–æ—á–µ–Ω—å —Å–ª–∞–±—ã–π": –º–µ–Ω–µ–µ –≤–∏–¥–∏–º—ã–π —à—É–º, –º–µ–Ω—å—à–µ –∑–∞—â–∏—Ç—ã
# - "—Å–ª–∞–±—ã–π": –±–∞–ª–∞–Ω—Å
# - "—Å—Ä–µ–¥–Ω–∏–π": —Ö–æ—Ä–æ—à–∏–π –±–∞–ª–∞–Ω—Å
# - "—Å–∏–ª—å–Ω—ã–π": –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –∑–∞—â–∏—Ç–∞ (MSE > 100)
```

## ‚úÖ –ß–µ–∫-–ª–∏—Å—Ç –ü—Ä–æ–≤–µ—Ä–∫–∏

- [x] –°–∏–Ω—Ç–∞–∫—Å–∏—Å media_cleaner.py –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω
- [x] –í—Å–µ –∏–º–ø–æ—Ä—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç
- [x] MSE —É–ª—É—á—à–µ–Ω —Å 4.73 –¥–æ 148.69 –¥–ª—è "—Å–∏–ª—å–Ω–æ–≥–æ" —É—Ä–æ–≤–Ω—è
- [x] –ü–∏–∫—Å–µ–ª–∏ –∏–∑–º–µ–Ω–µ–Ω—ã —Å 1.51% –¥–æ 96.59%
- [x] –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ —Ü–µ–ø–æ—á–∫—É —Ñ—É–Ω–∫—Ü–∏–π
- [x] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ GPU –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–∞–¥—Ä–æ–≤
- [x] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ GPU –¥–ª—è –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è –≤–∏–¥–µ–æ (NVENC)

## üîÆ –í–æ–∑–º–æ–∂–Ω—ã–µ –î–∞–ª—å–Ω–µ–π—à–∏–µ –£–ª—É—á—à–µ–Ω–∏—è

1. **–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π epsilon**: –≤—ã–±–∏—Ä–∞—Ç—å epsilon –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –≤–∏–¥–µ–æ
2. **FGSM —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º —à–∞–≥–æ–º**: –≤–º–µ—Å—Ç–æ –æ–¥–Ω–æ–≥–æ —à–∞–≥–∞ FGSM –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å PGD
3. **–°–º–µ—à–∞–Ω–Ω—ã–µ –¥–æ–º–µ–Ω—ã**: –ø—Ä–∏–º–µ–Ω—è—Ç—å –∞—Ç–∞–∫—É –≤ —á–∞—Å—Ç–æ—Ç–Ω–æ–º –¥–æ–º–µ–Ω–µ (DCT)
4. **Transfer attacks**: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–æ–¥–µ–ª–µ–π –¥–ª—è –±–æ–ª–µ–µ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–π –∑–∞—â–∏—Ç—ã
5. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ –≤—Ä–µ–º–µ–Ω–∏**: –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–∞–¥—Ä–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –±–∞—Ç—á–µ–π

## üìù –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —É–ª—É—á—à–µ–Ω–∏–π:
```bash
# –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç MSE –Ω–∞ –æ–¥–Ω–æ–º –∫–∞–¥—Ä–µ
python quick_mse_test.py

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ –∏ –∏–º–ø–æ—Ä—Ç–æ–≤
python test_syntax_and_imports.py

# –ü–æ–ª–Ω—ã–π —Ç–µ—Å—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤–∏–¥–µ–æ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
python test_full_processing.py
```

---

**–í–µ—Ä—Å–∏—è:** 2.1 (2026-01-13)
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
